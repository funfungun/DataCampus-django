{% load static %}
{% load mathfilters %}
<link rel="stylesheet" type="text/css" href="{% static 'bootstrap.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'homes.css' %}">

<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width", initial-scale="1">
        <title>집! 콕!</title>
        <script>
            function goBack() {
                window.history.back();
            }
            
            document.addEventListener("DOMContentLoaded", function() {
                var result_2 = {{ result_2 | safe }};  
                if (Object.keys(result_2).length === 0) {
                    alert("해당 조건을 만족하는 우편번호가 없습니다. 다시 선택해주세요.");
                    goBack();
                }
            }); 
        </script>
    </head>
    <body>
        <style type="text/css">
            blockquote {
                background: #f9f9f9;
                border-Left: 10px solid #cccccc;
                margin: 1.5em 10px;
                padding: 0.5em 10px;
                quotes: "\201C""\201D""\2018""\2019";
            }
            blockquote:before {
                color: #cccccc;
                content: open-quote;
                font-size: 3em;
                line-height: 0.1em;
                margin-Left: 11.5em;
                vertical-align: -0.4em;
            }
            blockquote:after {
                color: #cccccc;
                content: close-quote;
                font-size: 3em;
                line-height: 0.1em;
                margin-left: 0.25em;
                vertical-align: -0.4em;
            }
        </style>
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                        <span class="sr-only"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">메인화면</a>
                </div>
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav navbar-center">
                        <li><a href="#">지역/금액 선택<span class="sr-only"></span></a></li>
                        <li><a href="#">인접시설 선택</a></li>
                        <li><a href="#">세부사항 입력</a></li>
                        <li class="active"><a href="#">결과 확인</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        {% for key, value in result_2.items %}
    {% for key2, value2 in result_3.items %}
    {% if key == key2 %}
    <div class="info-map-container">
        <div class="row">
            <div class="col-md-12"> <!-- 나머지 정보 -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="map-container">
                            <ul class="text-center">
                                <li><h3><b>추천우편번호 : {{key}}</b></h3></li>
                                <li>주소 : {{value.city_gu}} {{value.admin_dong}}</li>
                                {% if monf == 0 %}
                                    <li>전세 : {{value.avg_cost}}만원</li>
                                {% endif %}
                                {% if monf != 0 %}
                                    <li>보증금 : {{mon}}만원</li> 
                                    <li>월세 : {% with avg_cost_diff=value.avg_cost|sub:mon %}
                                        {% with avg_cost_diff_multiplied=avg_cost_diff|mul:0.052 %}
                                            {% with avg_cost_final=avg_cost_diff_multiplied|div:12 %}
                                                {{ avg_cost_final|floatformat:0 }}만원
                                            {% endwith %}
                                        {% endwith %}
                                    {% endwith %}
                                    </li>
                                {% endif %}
                                <li>총 소요시간 : {{value.totalTime}}분</li>
                                {% if value.walk_sum != 0 %}
                                    <li>걷기 : {{value.walk_sum}}분</li>
                                {% endif %}
                                {% if value.bus_sum != 0 %}
                                    <li>버스 : {{value.bus_sum}}분</li>
                                {% endif %}
                                {% if value.subway_sum != 0 %}
                                    <li>지하철 : {{value.subway_sum}}분</li>
                                {% endif %}
                                <button class="button1" onclick="window.open('{{key}}/', 'image_window', 'width=1000,height=600,location=no,status=no,scrollbars=yes');">관련정보보기</button>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6"> <!-- 지도 1 -->
                <div class="map-container">
                    {{value.map | safe}}
                </div>
            </div>
            <div class="col-md-6"> <!-- 지도 2 -->
                <div class="map-container">
                    {{value2.map2 | safe}}
                </div>
            </div>
        </div>
    </div>
    <hr>
    <hr>
    {% endif %}
    {% endfor %}
    {% endfor %}
    <footer class="footer-fixed" style="background-color: rgb(64, 154, 206); color: #ffffff">
        <div class="container">
            <br>
            <div class="row">
                <div class="col-sm-2" style="text-align: center;"><h5>Copyright &copy; 2023</h5><h5>Orara..?</h5></div>
            </div>
        </div>
    </footer>
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script src="{% static 'bootstrap.js' %}"></script>
        <script>
            document.getElementById("popupButton").addEventListener("click", function() {
                var key = "{{key}}";
                var url = key + "/";
                window.open(url, "image_window", "width=1000,height=600,location=no,status=no,scrollbars=yes");
            });
        </script>
        <script>
            function goBack() {
              window.history.back();
            }
        </script>
    </body>
</html>